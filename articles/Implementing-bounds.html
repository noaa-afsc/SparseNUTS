<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Implementing parameter transformations in SNUTS • SparseNUTS</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Implementing parameter transformations in SNUTS">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SparseNUTS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/SparseNUTS.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/advanced-usage.html">Advanced usage</a></li>
    <li><a class="dropdown-item" href="../articles/Implementing-bounds.html">Implementing parameter transformations in SNUTS</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/noaa-afsc/SparseNUTS/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Implementing parameter transformations in SNUTS</h1>
                        <h4 data-toc-skip class="author">Cole C.
Monnahan</h4>
            
            <h4 data-toc-skip class="date">2026-02-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/noaa-afsc/SparseNUTS/blob/main/vignettes/Implementing-bounds.Rmd" class="external-link"><code>vignettes/Implementing-bounds.Rmd</code></a></small>
      <div class="d-none name"><code>Implementing-bounds.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://noaa-afsc.github.io/SparseNUTS">SparseNUTS</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/kaskr/RTMB" class="external-link">RTMB</a></span><span class="op">)</span></span></code></pre></div>
<p>One major difference with the Stan and ADMB platforms is that SNUTS
does not natively handle parameter transformations such as box
constraints. <code>StanEstimator::stan_sample</code> has arguments for
lower and upper bounds of parameters, but this functionality is not
compatible with SNUTS because the decorrelation happens prior to
applying the transformations. Instead, the analyst must do this manually
in the model code, and include a Jacobian manually as needed.</p>
<p>This article demonstrates how to implement parameter transformations
in RTMB for strictly positive parameters (e.g., variances) as well as a
box constraint with a lower and upper bound (e.g., a probability). These
are based on the Jacobians defined <a href="https://mc-stan.org/docs/reference-manual/transforms.html#variable-transforms.chapter" class="external-link">here</a>.
A similar approach would be used in TMB as well.</p>
<p>When is a Jacobian necessary? According to the <a href="https://mc-stan.org/docs/stan-users-guide/reparameterization.html#change-of-variables-vs.-transformations" class="external-link">Stan
manual</a>: ‘A transformation samples a parameter, then transforms it,
whereas a change of variables transforms a parameter, then samples it.
Only the latter requires a Jacobian adjustment.’</p>
<p>The model below demonstrates how to use Jacobians and what happens if
you do not include them. The overall idea is to define several
parameters with different transformations (log and logit) and put
explicit priors on them in a model without data. Then the posterior
samples will be from the priors and an analytical posterior known.
Specifically, each parameter is duplicated to include (right) or not
(wrong) the Jacobian, and the model is then integrated to show the
change in the posterior that results. Note that the Jacobians are added
to the log-density and negated at the end. A user can copy the Jacobians
used here to account for this change-of-variable scenario. Just be
mindful of getting the sign right!</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://noaa-afsc.github.io/SparseNUTS">SparseNUTS</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/kaskr/RTMB" class="external-link">RTMB</a></span><span class="op">)</span></span>
<span><span class="co"># parameters in the transformed space</span></span>
<span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>log_sigma_right<span class="op">=</span><span class="fl">0</span>, log_sigma_wrong<span class="op">=</span><span class="fl">0</span>,</span>
<span>             logit_p_right<span class="op">=</span><span class="fl">0</span>, logit_p_wrong<span class="op">=</span><span class="fl">0</span>,</span>
<span>             logit_box_right<span class="op">=</span><span class="fl">0</span>, logit_box_wrong<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mu1<span class="op">=</span><span class="fl">10</span>, sd1<span class="op">=</span><span class="fl">2</span>,</span>
<span>            shape1<span class="op">=</span><span class="fl">2</span>, shape2<span class="op">=</span><span class="fl">8</span>,</span>
<span>            a<span class="op">=</span><span class="fl">0</span>, b<span class="op">=</span><span class="fl">8</span>,</span>
<span>            s2<span class="op">=</span><span class="fl">2</span>, r2<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span>            <span class="co">#mu2=50, sd2=20)</span></span>
<span><span class="va">func</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">pars</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/RTMB/man/TMB-interface.html" class="external-link">getAll</a></span><span class="op">(</span><span class="va">pars</span>, <span class="va">dat</span><span class="op">)</span></span>
<span>  <span class="co"># transform the parameters</span></span>
<span>  <span class="va">sigma_right</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">log_sigma_right</span><span class="op">)</span></span>
<span>  <span class="va">sigma_wrong</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">log_sigma_wrong</span><span class="op">)</span></span>
<span>  <span class="co"># these are constrained to be in (0,1)</span></span>
<span>  <span class="va">p_right</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">logit_p_right</span><span class="op">)</span></span>
<span>  <span class="va">p_wrong</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">logit_p_wrong</span><span class="op">)</span></span>
<span>  <span class="co"># constrained in (a,b)</span></span>
<span>  <span class="va">box_right</span> <span class="op">&lt;-</span> <span class="va">a</span> <span class="op">+</span> <span class="op">(</span><span class="va">b</span><span class="op">-</span><span class="va">a</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">logit_box_right</span><span class="op">)</span></span>
<span>  <span class="va">box_wrong</span> <span class="op">&lt;-</span> <span class="va">a</span> <span class="op">+</span> <span class="op">(</span><span class="va">b</span><span class="op">-</span><span class="va">a</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">logit_box_wrong</span><span class="op">)</span></span>
<span>  <span class="co"># add priors *after* inverse transformation</span></span>
<span>  <span class="va">lp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">sigma_right</span>, mean<span class="op">=</span><span class="va">mu1</span>, sd<span class="op">=</span><span class="va">sd1</span>, log<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">sigma_wrong</span>, mean<span class="op">=</span><span class="va">mu1</span>, sd<span class="op">=</span><span class="va">sd1</span>, log<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="va">p_right</span>, shape1<span class="op">=</span><span class="va">shape1</span>, shape2<span class="op">=</span><span class="va">shape2</span>, log<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="va">p_wrong</span>, shape1<span class="op">=</span><span class="va">shape1</span>, shape2<span class="op">=</span><span class="va">shape2</span>, log<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="co"># this is a truncated gamma since bounded (a,b)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">box_right</span>, shape<span class="op">=</span><span class="va">s2</span>, rate<span class="op">=</span><span class="va">r2</span>, log<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">box_wrong</span>, shape<span class="op">=</span><span class="va">s2</span>, rate<span class="op">=</span><span class="va">r2</span>, log<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span> <span class="co"># add Jacobians to the "right" ones</span></span>
<span>  <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">logit_box_right</span><span class="op">)</span></span>
<span>  <span class="va">lp</span> <span class="op">&lt;-</span> <span class="va">lp</span> <span class="op">+</span> <span class="va">log_sigma_right</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">p_right</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p_right</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="op">(</span><span class="va">b</span><span class="op">-</span><span class="va">a</span><span class="op">)</span><span class="op">*</span><span class="va">tmp</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">tmp</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="co"># note the lack of jacobians for the "wrong" ones</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/RTMB/man/TMB-interface.html" class="external-link">REPORT</a></span><span class="op">(</span><span class="va">sigma_right</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/RTMB/man/TMB-interface.html" class="external-link">REPORT</a></span><span class="op">(</span><span class="va">sigma_wrong</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/RTMB/man/TMB-interface.html" class="external-link">REPORT</a></span><span class="op">(</span><span class="va">p_right</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/RTMB/man/TMB-interface.html" class="external-link">REPORT</a></span><span class="op">(</span><span class="va">p_wrong</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/RTMB/man/TMB-interface.html" class="external-link">REPORT</a></span><span class="op">(</span><span class="va">box_right</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/RTMB/man/TMB-interface.html" class="external-link">REPORT</a></span><span class="op">(</span><span class="va">box_wrong</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="op">-</span><span class="va">lp</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">func</span><span class="op">(</span><span class="va">pars</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 37.15916</span></span>
<span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu">MakeADFun</span><span class="op">(</span><span class="va">func</span>, parameters<span class="op">=</span><span class="va">pars</span><span class="op">)</span></span></code></pre></div>
<p>Posterior samples can then be drawn using SNUTS.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_snuts.html">sample_snuts</a></span><span class="op">(</span><span class="va">obj</span>, seed<span class="op">=</span><span class="fl">1</span>, chains<span class="op">=</span><span class="fl">1</span>, refresh<span class="op">=</span><span class="fl">0</span>,</span>
<span>                    num_samples<span class="op">=</span><span class="fl">5000</span>, model_name<span class="op">=</span><span class="st">'jacobian_test'</span><span class="op">)</span></span>
<span><span class="co">#&gt; Optimizing...</span></span>
<span><span class="co">#&gt; Rebuilding RTMB obj without random effects...</span></span>
<span><span class="co">#&gt; diag metric selected b/c low correlations (max=0)</span></span>
<span><span class="co">#&gt; log-posterior at inits=(-1.42); at conditional mode=-1.416</span></span>
<span><span class="co">#&gt; Starting MCMC sampling...</span></span></code></pre></div>
<p>And then the posterior compared to the known truth (the priors), with
and without the Jacobian adjustments. Without the Jacobian the posterior
is wrong because the change in volume from the transformation is not
accounted for.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">post</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="va">xx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">post</span>, <span class="fl">1</span>, \<span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="va">obj</span><span class="op">$</span><span class="fu">report</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">lwd</span> <span class="op">&lt;-</span> <span class="fl">2.5</span></span>
<span><span class="va">breaks</span> <span class="op">&lt;-</span> <span class="fl">40</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">xx</span><span class="op">$</span><span class="va">sigma_right</span>, xlab<span class="op">=</span><span class="st">''</span>, main<span class="op">=</span><span class="st">'sigma_right'</span>, breaks<span class="op">=</span><span class="va">breaks</span>,</span>
<span>     freq<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">x</span>, mean<span class="op">=</span><span class="va">dat</span><span class="op">$</span><span class="va">mu1</span>, sd<span class="op">=</span><span class="va">dat</span><span class="op">$</span><span class="va">sd1</span><span class="op">)</span>,</span>
<span>      from<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">xx</span><span class="op">$</span><span class="va">sigma_right</span><span class="op">)</span>,</span>
<span>      to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">xx</span><span class="op">$</span><span class="va">sigma_right</span><span class="op">)</span>, add<span class="op">=</span><span class="cn">TRUE</span>, lwd<span class="op">=</span><span class="va">lwd</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">xx</span><span class="op">$</span><span class="va">sigma_wrong</span>, xlab<span class="op">=</span><span class="st">'n'</span>, main<span class="op">=</span><span class="st">'sigma_wrong'</span>,breaks<span class="op">=</span><span class="va">breaks</span>,</span>
<span>     freq<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">x</span>, mean<span class="op">=</span><span class="va">dat</span><span class="op">$</span><span class="va">mu1</span>, sd<span class="op">=</span><span class="va">dat</span><span class="op">$</span><span class="va">sd1</span><span class="op">)</span>,</span>
<span>      from<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">xx</span><span class="op">$</span><span class="va">sigma_wrong</span><span class="op">)</span>,</span>
<span>      to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">xx</span><span class="op">$</span><span class="va">sigma_wrong</span><span class="op">)</span>, add<span class="op">=</span><span class="cn">TRUE</span>, lwd<span class="op">=</span><span class="va">lwd</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">xx</span><span class="op">$</span><span class="va">p_right</span>, xlab<span class="op">=</span><span class="st">''</span>, main<span class="op">=</span><span class="st">'p_right'</span>, breaks<span class="op">=</span><span class="va">breaks</span>,</span>
<span>     freq<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="va">x</span>, shape1<span class="op">=</span><span class="va">dat</span><span class="op">$</span><span class="va">shape1</span>, shape2<span class="op">=</span><span class="va">dat</span><span class="op">$</span><span class="va">shape2</span><span class="op">)</span>,</span>
<span>      from<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">xx</span><span class="op">$</span><span class="va">p_right</span><span class="op">)</span>,</span>
<span>      to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">xx</span><span class="op">$</span><span class="va">p_right</span><span class="op">)</span>, add<span class="op">=</span><span class="cn">TRUE</span>, lwd<span class="op">=</span><span class="va">lwd</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">xx</span><span class="op">$</span><span class="va">p_wrong</span>, xlab<span class="op">=</span><span class="st">''</span>, main<span class="op">=</span><span class="st">'p_wrong'</span>,breaks<span class="op">=</span><span class="va">breaks</span>,</span>
<span>     freq<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="va">x</span>, shape1<span class="op">=</span><span class="va">dat</span><span class="op">$</span><span class="va">shape1</span>, shape2<span class="op">=</span><span class="va">dat</span><span class="op">$</span><span class="va">shape2</span><span class="op">)</span>,</span>
<span>      from<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">xx</span><span class="op">$</span><span class="va">p_wrong</span><span class="op">)</span>,</span>
<span>      to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">xx</span><span class="op">$</span><span class="va">p_wrong</span><span class="op">)</span>, add<span class="op">=</span><span class="cn">TRUE</span>, lwd<span class="op">=</span><span class="va">lwd</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">xx</span><span class="op">$</span><span class="va">box_right</span>, xlab<span class="op">=</span><span class="st">''</span>, main<span class="op">=</span><span class="st">'box_right'</span>, breaks<span class="op">=</span><span class="va">breaks</span>,</span>
<span>     freq<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># technically a truncated gamma but tiny amount of mass outside</span></span>
<span><span class="co"># bounds so ignoring it for plotting</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">x</span>, shape<span class="op">=</span><span class="va">dat</span><span class="op">$</span><span class="va">s2</span>, rate<span class="op">=</span><span class="va">dat</span><span class="op">$</span><span class="va">r2</span><span class="op">)</span>,</span>
<span>      from<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">xx</span><span class="op">$</span><span class="va">box_right</span><span class="op">)</span>,</span>
<span>      to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">xx</span><span class="op">$</span><span class="va">box_right</span><span class="op">)</span>, add<span class="op">=</span><span class="cn">TRUE</span>, lwd<span class="op">=</span><span class="va">lwd</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">xx</span><span class="op">$</span><span class="va">box_wrong</span>, xlab<span class="op">=</span><span class="st">''</span>, main<span class="op">=</span><span class="st">'box_wrong'</span>, breaks<span class="op">=</span><span class="va">breaks</span>,</span>
<span>     freq<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">x</span>, shape<span class="op">=</span><span class="va">dat</span><span class="op">$</span><span class="va">s2</span>, rate<span class="op">=</span><span class="va">dat</span><span class="op">$</span><span class="va">r2</span><span class="op">)</span>,</span>
<span>      from<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">xx</span><span class="op">$</span><span class="va">box_wrong</span><span class="op">)</span>,</span>
<span>      to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">xx</span><span class="op">$</span><span class="va">box_wrong</span><span class="op">)</span>, add<span class="op">=</span><span class="cn">TRUE</span>, lwd<span class="op">=</span><span class="va">lwd</span><span class="op">)</span></span></code></pre></div>
<p><img src="Implementing-bounds_files/figure-html/makeplot-1.png" class="r-plt" alt="" width="700"></p>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Cole Monnahan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
